# Analysing Malicious Documents

### General Approach to Document Analysis (SANS DFIR Approach)

1. Examine the document for anomalies, such as risky tags, scripts, or other anomalous aspects.
2. Locate embedded code, such as shellcode, VBA macros, JavaScript or other suspicious objects.
3. Extract suspicious code or object from the file.
4. If relevant, deobfuscate and examine JavaScript or macro code.
5. If relevant, disassemble and/or debug shellcode. 
6. Understand the next steps in the infection chain. 

## PDF


## Office Documents

### oledump

oledump.py is a program to analyze OLE files (Compound File Binary Format). These files contain streams of data. oledump allows you to analyze these streams. Will not work on new file formats such as docx, xlsx, etc.

Command | Description
---- | ----
oledump.py filename | List all OLE2 streams present
oledump.py -s streamnumber -v filename | Extract macros stored inside stream number
oledump.py -M filename | Extract metadata from file

#### References
https://digital-forensics.sans.org/media/analyzing-malicious-document-files.pdf
https://blog.didierstevens.com/programs/oledump-py/
